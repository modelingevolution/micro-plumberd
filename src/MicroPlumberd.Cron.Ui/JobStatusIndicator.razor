@inject IJobsMonitor monitor


@if (Parent != null)
{
    @if (context != null)
    {
        @if (context.IsRunning)
        {
            <MudProgressCircular Class="pa-0 my-0" 
                                 Style="margin-right:8px; height:18px;width:18px"
                                 Indeterminate="true" 
                                 Size="Size.Small" 
                                 Color="Color.Success"/>
        }

        @if (StatusEnabled)
        { 
            @context.Status
        }
    }
}
else
{
    <JobMonitorObservable>
        @if (context != null)
        {
            @if (context.IsRunning)
            {
                <MudProgressCircular Class="pa-0 mx-2"
                                     Indeterminate="true" Size="Size.Small" Color="Color.Success"/>
            }
            @if (StatusEnabled)
            {
                @context.Status
            }

        }
    </JobMonitorObservable>
}


@code {
    private IItem? context;

    /// <summary>
    /// Gets or sets the unique identifier of the job definition to display status for.
    /// </summary>
    [Parameter]
    public Guid JobDefinitionId { get; set; }

    /// <summary>
    /// Gets or sets whether to display the textual status alongside the visual indicator.
    /// Default value is true.
    /// </summary>
    [Parameter]
    public bool StatusEnabled { get; set; } = true;

    /// <summary>
    /// Gets or sets the parent JobMonitorObservable component when this component is nested within one.
    /// When null, the component creates its own JobMonitorObservable wrapper.
    /// </summary>
    [CascadingParameter]
    public JobMonitorObservable? Parent { get; set; }

    protected override void OnParametersSet()
    {
        this.context = monitor.GetById(JobDefinitionId);
    }

}